<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="../../static/lib/bootstrap/css/bootstrap.min.css" th:href="@{/lib/bootstrap/css/bootstrap.min.css}">
    <link rel="stylesheet" href="../../static/lib/animate/animate.css" th:href="@{/lib/animate/animate.css}">
    <link rel="stylesheet" href="../../static/lib/fontawesome/css/font-awesome.css" th:href="@{/lib/fontawesome/css/font-awesome.min.css}">
    <link rel="stylesheet" href="../../static/lib/highlight/agate.min.css" th:href="@{/lib/highlight/agate.min.css}">
    <link rel="stylesheet" href="../../static/lib/bootstrap/css/bootstrap.rtl.css" th:href="@{/lib/bootstrap/css/bootstrap.rtl.css}">
    <link rel="stylesheet" href="../../static/css/download-page.css" th:href="@{/css/download-page.css}">
    <link rel="stylesheet" href="../../static/css/me.css" th:href="@{/css/me.css}">
    <link rel="stylesheet" href="../../static/css/gallery-page.css" th:href="@{/css/gallery-page.css}">
    <link rel="stylesheet" href="../../static/css/wiki-page.css" th:href="@{/css/wiki-page.css}">
    <!-- @{/} 斜杠开头表示相对整个应用根目录，此处必须这样写。不然在提交/admin/modFileManagement请求时会在静态资源路径上加上/admin导致404错误。 -->
    <title>MOD文件管理</title>
</head>
<body>
    <nav class="navbar navbar-dark py-sm-1 fixed-top" id="nav_bar">
        <div class="container-lg row h-100">
            <a class="navbar-brand col-3 h-100" href="./" th:href="@{/}">
                <img src="../../static/images/kuayue_logo.png" th:src="@{/images/kuayue_logo.png}" alt="logo" class="w-25">
                <span class="nav_bar_button"><strong>跨越</strong>&nbsp;|&nbsp;Kuayue</span>
            </a>
            <div class="col-1 h-100 dropdown">
                <a class="nav_bar_button dropdown-toggle" data-bs-toggle="dropdown" href="#">主站</a>
                <ul class="dropdown-menu">
                    <li><a href="#" th:href="@{/download}" class="dropdown-item" target="_blank">下载</a></li>
                    <li><a href="#" th:href="@{/gallery}" class="dropdown-item" target="_blank">画廊</a></li>
                    <li><a href="#" th:href="@{/wiki}" class="dropdown-item" target="_blank">百科</a></li>
                    <li><a href="#" th:href="@{/schematic}" class="dropdown-item" target="_blank">蓝图</a></li>
                    <li><a href="#" th:href="@{/bbs_entrance}" class="dropdown-item" target="_blank">论坛</a></li>
                </ul>
            </div>
            <div class="col-2 h-100 no_padding no_border no_background_color nav_bar_button">
                <a href="../download.html" th:href="@{/admin/modFileManagement}" class="no_text_decoration"><span class="nav_bar_button">MOD文件管理</span></a>
            </div>
            <div class="col-3"></div>

            <div class="col-2 h-100 no_padding no_border no_background_color">
                <div style="float: right">
                    <div class="dropdown">
                        <a class="nav_bar_button dropdown-toggle" data-bs-toggle="dropdown" href="#">
                            <img src="../../static/images/avatar/ayaka1.png" th:src="@{${session.user.avatar}}" style="max-width: 30px">
                            <span th:text="${session.user.nickname}">用户昵称</span>
                        </a>
                        <ul class="dropdown-menu">
                            <li><a href="#" th:href="@{/admin/user}" class="dropdown-item">个人主页</a></li>
                            <li><a href="#" th:href="@{/admin/logout}" class="dropdown-item">退出登录</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <div class="container-sm animate__animated animate__fadeIn" style="margin-top: 5em">
        <div class="row">
            <div class="col-10 bg-light" style="border-radius: 10px">
                <h2 style="margin-top: 0.5em; margin-left: 0.2em" class="m-xiaokai">上传MOD文件</h2>
                <hr>
                <form th:action="@{/admin/fileUpload}" method="post" enctype="multipart/form-data" style="margin-bottom: 0.5em">
                    <div class="mb-3 form-group">
                        <label for="selMenu" class="form-label">选择MC版本：</label>
                        <select class="form-select" id="selMenu" name="MCVersion" style="max-width: 450px">
                            <option>1.20.1</option>
                            <option>1.19.2</option>
                            <option>1.18.2</option>
                        </select>
                    </div>
                    <div class="mb-3 form-group">
                        <input type="file" name="uploadedFile">
                    </div>
                    <div class="mb-3 form-group">
                        <button type="submit" class="btn btn-dark">上传文件</button>
                    </div>
                    <!--注意这里的th文本表达式不应放在外层的div上，不然会将后面的关闭图标一起替换掉。-->
                    <div id="failure-info" th:unless="${#strings.isEmpty(fileUploadMessage)}"
                         class="alert alert-danger col-5" role="alert">
                        <div th:text="${fileUploadMessage}" class="col-10" style="display: inline-block">上传文件失败！</div>
                        <div id="failure-close" class="btn-close" style="display: inline-block; vertical-align: top"></div>
                    </div>
                    <div id="success-info" th:unless="${#strings.isEmpty(uploadSuccessMessage)}"
                         class="alert alert-success col-5" role="alert">
                        <div th:text="${uploadSuccessMessage}" class="col-10" style="display: inline-block">上传文件成功！</div>
                        <div id="success-close" class="btn-close" style="display: inline-block;vertical-align: top"></div>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div id="waypoint" class="container-sm animate__animated animate__fadeIn" style="margin-top: 5em; margin-bottom: 10em">
        <div class="row">
            <div class="col-10 bg-light" style="border-radius: 10px">
                <div>
                    <h2 style="margin-top: 0.5em; margin-left: 0.2em" class="m-xiaokai">文件列表</h2>
                </div>
                <hr>
                <table class="table">
                    <thead class="table-dark">
                    <tr>
                        <th>运行环境</th>
                        <th>MOD文件名</th>
                        <th>MC版本</th>
                        <th>下载量</th>
                        <th>操作</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="file, fileStat : ${allModFiles}">
                        <td th:text="${file.id}">forge</td>
                        <td th:text="${file.modFileName}">kuayue-0.3.5m-izayoi_sakuya-rc2.jar</td>
                        <td th:text="${file.MCVersion}">1.20.1</td>
                        <td th:text="${file.downloadCounts}">776</td>
                        <td>
                            <a href="#" class="download_button" style="text-decoration: none">下载</a>
                            <a href="#" class="download_button" style="text-decoration: none">修改</a>
                            <a href="#" class="download_button" style="text-decoration: none">删除</a>
                        </td>
                    </tr>
                    <!--/*-->
                    <tr>
                        <td>forge</td>
                        <td>kuayue-0.3.5m-izayoi_sakuya-rc2.jar</td>
                        <td>1.20.1</td>
                        <td>776</td>
                        <td>
                            <a href="#" class="download_button" style="text-decoration: none">下载</a>
                            <a href="#" class="download_button" style="text-decoration: none">修改</a>
                            <a href="#" class="download_button" style="text-decoration: none">删除</a>
                        </td>
                    </tr>
                    <!--*/-->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script src="../../static/lib/jquery/jquery-3.7.1.js" th:src="@{/lib/jquery/jquery-3.7.1.js}"></script>
    <script src="../../static/lib/bootstrap/js/bootstrap.bundle.min.js" th:src="@{/lib/bootstrap/js/bootstrap.bundle.min.js}"></script>
    <script src="../../static/lib/highlight/highlight.min.js" th:src="@{/lib/highlight/highlight.min.js}"></script>
    <script src="../../static/lib/waypoints/jquery.waypoints.min.js" th:src="@{/lib/waypoints/jquery.waypoints.min.js}"></script>
    <script src="../../static/js/home_page.js" th:src="@{/js/home_page.js}"></script>

    <script type="text/javascript">
        $('#failure-close').click(function () {
            $('#failure-info').hide();
        })
        $('#success-close').click(function () {
            $('#success-info').hide();
        })
    </script>
</body>
</html>
